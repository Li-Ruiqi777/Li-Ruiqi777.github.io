<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ultralytics库使用指南 | Hexo</title><meta name="author" content="Gearless Joe"><meta name="copyright" content="Gearless Joe"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta name="description" content="ultralytics库使用指南ultralytics就是个类似Paddle Detection的库，里面实现了一堆YOLO系的模型，以及SAM什么的。并搭建好了模型的train, export, predict, val, benchmark等的框架，用户可以直接调用。唯一的区别就是一个是国内的，一个是国外的。 1.全局配置ultralytics库将&#x3D;&#x3D;全局配置&#x3D;&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="ultralytics库使用指南">
<meta property="og:url" content="https://li-ruiqi777.github.io/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/ultralytics%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="ultralytics库使用指南ultralytics就是个类似Paddle Detection的库，里面实现了一堆YOLO系的模型，以及SAM什么的。并搭建好了模型的train, export, predict, val, benchmark等的框架，用户可以直接调用。唯一的区别就是一个是国内的，一个是国外的。 1.全局配置ultralytics库将&#x3D;&#x3D;全局配置&#x3D;&amp;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://li-ruiqi777.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-06-04T08:29:12.870Z">
<meta property="article:modified_time" content="2025-06-04T08:29:38.807Z">
<meta property="article:author" content="Gearless Joe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://li-ruiqi777.github.io/img/butterfly-icon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://li-ruiqi777.github.io/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/ultralytics%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ultralytics库使用指南',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hexo</span></a><a class="nav-page-title" href="/"><span class="site-name">ultralytics库使用指南</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">ultralytics库使用指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-06-04T08:29:12.870Z" title="Created 2025-06-04 16:29:12">2025-06-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-06-04T08:29:38.807Z" title="Updated 2025-06-04 16:29:38">2025-06-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">11-深度学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="ultralytics库使用指南"><a href="#ultralytics库使用指南" class="headerlink" title="ultralytics库使用指南"></a>ultralytics库使用指南</h1><p><code>ultralytics</code>就是个类似<code>Paddle Detection</code>的库，里面实现了一堆YOLO系的模型，以及SAM什么的。并搭建好了模型的<strong>train, export, predict, val, benchmark</strong>等的框架，用户可以直接调用。唯一的区别就是一个是国内的，一个是国外的。</p>
<h2 id="1-全局配置"><a href="#1-全局配置" class="headerlink" title="1.全局配置"></a>1.全局配置</h2><p><code>ultralytics</code>库将&#x3D;&#x3D;全局配置&#x3D;&#x3D;（主要是路径之类的）存放在一个<code>YAML</code>文件中，并由<code>SettingsManager</code>这个类对该文件进行I&#x2F;O操作。该库不只只有这个配置文件。</p>
<h3 id="1-1配置文件的路径"><a href="#1-1配置文件的路径" class="headerlink" title="1.1配置文件的路径"></a>1.1配置文件的路径</h3><p>在创建这个类的实例时，需要指定这个配置文件的路径，默认是<code>USER_CONFIG_DIR/settings.yaml</code>，但也可以直接自己指定。<code>USER_CONFIG_DIR</code>是<code>YOLO_CONFIG_DIR</code>这个&#x3D;&#x3D;<strong>环境变量</strong>&#x3D;&#x3D;的值，如果系统没这个环境变量的话，就由<code>get_user_config_dir()</code>这个函数返回。</p>
<p>在windows下返回的地址就是<code>C:\Users\lrq\AppData\Roaming\Ultralytics</code></p>
<h3 id="1-2全局配置包括啥？"><a href="#1-2全局配置包括啥？" class="headerlink" title="1.2全局配置包括啥？"></a>1.2全局配置包括啥？</h3><img src="../assets/image-20231109170747825.png" alt="image-20231109170747825"  />

<h3 id="1-3全局配置的修改"><a href="#1-3全局配置的修改" class="headerlink" title="1.3全局配置的修改"></a>1.3全局配置的修改</h3><ul>
<li>直接打开配置文件修改</li>
<li>在代码中使用API修改</li>
</ul>
<h2 id="2-超参数配置"><a href="#2-超参数配置" class="headerlink" title="2.超参数配置"></a>2.超参数配置</h2><p>除了上面那个全局配置文件<code>settings.yaml</code>，还有一个非常重要的配置文件<code>ultralytics\cfg\default.yaml</code>，这个文件主要包括以下几部分：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">task:</span> <span class="string">detect</span>  <span class="comment"># (str) YOLO task, i.e. detect, segment, classify, pose</span></span><br><span class="line"><span class="attr">mode:</span> <span class="string">train</span>  <span class="comment"># (str) YOLO mode, i.e. train, val, predict, export, track, benchmark</span></span><br><span class="line"><span class="comment"># Train settings</span></span><br><span class="line"><span class="attr">model:</span>  <span class="comment"># (str, optional) path to model file, i.e. yolov8n.pt, yolov8n.yaml</span></span><br><span class="line"><span class="attr">data:</span>  <span class="comment"># (str, optional) path to data file, i.e. coco128.yaml</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="comment"># Val/Test settings</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="comment"># Prediction settings</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="comment"># Export settings</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="comment"># Hyperparameters(学习率、数据增强策略等)</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="comment"># Custom config.yaml</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="comment"># Tracker settings</span></span><br><span class="line"><span class="string">....</span></span><br></pre></td></tr></table></figure>

<p>可能比较关键的参数有</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">imgsz</span>   <span class="comment"># 图像被预处理resize的尺寸，必须是32的倍数。</span></span><br><span class="line"><span class="comment">#&#x27;train&#x27; and &#x27;val&#x27; imgsz must be an integer, while &#x27;predict&#x27; and &#x27;export&#x27; imgsz may be a [h, w] list or an integer</span></span><br><span class="line"></span><br><span class="line"><span class="string">model</span>   <span class="comment"># 预训练模型或初始模型路径</span></span><br><span class="line"><span class="string">data</span>    <span class="comment"># 上文 coco.yaml 的路径</span></span><br><span class="line"><span class="string">epochs</span>  <span class="comment"># 迭代轮数</span></span><br><span class="line"><span class="string">batch</span>   <span class="comment"># 根据显存调节</span></span><br><span class="line"><span class="string">device</span>  <span class="comment"># 调用显卡数量，如：0,1,2,3</span></span><br><span class="line"><span class="string">workers</span> <span class="comment"># 调用 cpu 核心数）</span></span><br><span class="line"><span class="string">resume</span>  <span class="comment"># 是否为断点续训，若是，则需把 model 路径改为上次保存的 best.pt 的路径</span></span><br></pre></td></tr></table></figure>

<p>在程序运行时，首先会读取默认的配置文件<code>default.yaml</code>里的内容，然后将会用户自定义的配置文件（也就是cfg字段指向的那个<code>yaml</code>文件）中的内容<strong>覆盖</strong>掉默认的，再进行后边的任务。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">model = YOLO(<span class="string">&#x27;yolov8n.pt&#x27;</span>)</span><br><span class="line">model.train(**&#123;<span class="string">&#x27;cfg&#x27;</span>:<span class="string">&#x27;ultralytics/cfg/exp1.yaml&#x27;</span>, <span class="string">&#x27;data&#x27;</span>:<span class="string">&#x27;dataset/data.yaml&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用yaml配置文件来创建模型,并导入预训练权重.</span></span><br><span class="line">model = YOLO(<span class="string">&#x27;ultralytics/cfg/models/v8/yolov8.yaml&#x27;</span>)</span><br><span class="line">model.load(<span class="string">&#x27;yolov8n.pt&#x27;</span>)</span><br><span class="line">model.train(**&#123;<span class="string">&#x27;cfg&#x27;</span>:<span class="string">&#x27;ultralytics/cfg/exp1.yaml&#x27;</span>, <span class="string">&#x27;data&#x27;</span>:<span class="string">&#x27;dataset/data.yaml&#x27;</span>,<span class="string">&#x27;batch&#x27;</span>:<span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型验证</span></span><br><span class="line">model = YOLO(<span class="string">&#x27;runs/detect/yolov8n_exp/weights/best.pt&#x27;</span>)</span><br><span class="line">model.val(**&#123;<span class="string">&#x27;data&#x27;</span>:<span class="string">&#x27;dataset/data.yaml&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型推理</span></span><br><span class="line">model = YOLO(<span class="string">&#x27;runs/detect/yolov8n_exp/weights/best.pt&#x27;</span>)</span><br><span class="line">model.predict(source=<span class="string">&#x27;dataset/images/test&#x27;</span>, **&#123;<span class="string">&#x27;save&#x27;</span>:<span class="literal">True</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>model.train()、model.val()、model.predict()的形参中都可以传入新的参数<strong>覆盖</strong>掉<code>default.yaml</code>里的内容。</p>
<blockquote>
<p>最好针对不同的实验准备不同的超参数配置文件，避免在<code>default</code>里面改来改去。</p>
</blockquote>
<h2 id="3-数据集配置"><a href="#3-数据集配置" class="headerlink" title="3.数据集配置"></a>3.数据集配置</h2><p>在该库中，数据集也需要用一个<code>YAML</code>文件描述，需要在该<code>YAML</code>文件中给出路径及类别数和类别名称，并将数据集按YOLO格式放在文件夹之中。</p>
<p><img src="../assets/image-20231111193822108.png" alt="image-20231111193822108"></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -------------- dataset\data.yaml --------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># dataset path</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">F:/DeepLearning/3_ObjectDtect/ultralytics/dataset/</span></span><br><span class="line"><span class="attr">train:</span> <span class="string">images/train</span></span><br><span class="line"><span class="attr">val:</span> <span class="string">images/val</span></span><br><span class="line"><span class="attr">test:</span> <span class="string">images/test</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># number of classes</span></span><br><span class="line"><span class="attr">nc:</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># class names</span></span><br><span class="line"><span class="attr">names:</span> [<span class="string">&#x27;ship&#x27;</span>]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>dataset的yaml文件中也有<code>nc</code>这个字段（没的话会根据names长度自动生成），这个字段会覆盖<strong>模型结构</strong><code>yaml</code>文件的nc的值，从而<strong>影响模型最后一层的结构</strong>。</p>
</blockquote>
<h2 id="4-如何确定模型网络结构"><a href="#4-如何确定模型网络结构" class="headerlink" title="4.如何确定模型网络结构"></a>4.如何确定模型网络结构</h2><h3 id="4-1使用官方提供的模型"><a href="#4-1使用官方提供的模型" class="headerlink" title="4.1使用官方提供的模型"></a>4.1使用官方提供的模型</h3><p>该库中所有YOLO系列的模型都是一个类(<code>YOLO</code>)，通过改变<strong>实例化</strong>该对象时传入的<strong>模型结构文件</strong>、<strong>权重文件</strong>，即可创建不同的YOLO模型(v3, v5, v8)</p>
<ul>
<li><strong>模型结构文件</strong>指的是<code>ultralytics/cfg/models/</code>路径下的那些<code>YAML</code>格式的文件</li>
<li>权重文件就是<code>pytroch</code>框架下的权重文件(<code>.pt</code>)</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ultralytics <span class="keyword">import</span> YOLO</span><br><span class="line"></span><br><span class="line">model = YOLO(<span class="string">&#x27;yolov8n.pt&#x27;</span>) 	<span class="comment">#模型结构文件</span></span><br><span class="line">model = YOLO(<span class="string">&#x27;yolov8n.yaml&#x27;</span>)	<span class="comment">#权重文件</span></span><br></pre></td></tr></table></figure>

<p>注意<code>models</code>文件夹里面其实没有<code>yolov8n.yaml</code>，只有<code>yolov8.yaml</code>。当输入<code>yolov8n</code>时，<code>Model</code>类的源码里的一个函数<code>yaml_model_load()</code>会识别出<code>scale = n</code>，然后自动修改模型的结构。</p>
<p><img src="../assets/image-20231109210014300.png" alt="image-20231109210014300"></p>
<h4 id="4-1-1模型创建的过程"><a href="#4-1-1模型创建的过程" class="headerlink" title="4.1.1模型创建的过程"></a>4.1.1模型创建的过程</h4><p><img src="../assets/image-20231110172226469.png" alt="image-20231110172226469"></p>
<p>整个模型创建的过程非常繁琐，重要的函数的调用顺序如上图所示。</p>
<h4 id="4-2-2配置文件的写法"><a href="#4-2-2配置文件的写法" class="headerlink" title="4.2.2配置文件的写法"></a>4.2.2配置文件的写法</h4><p>随便找一个配置文件：</p>
<p><strong>一、模型尺度部分</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nc:</span> <span class="number">80</span>  <span class="comment"># number of classes</span></span><br><span class="line"><span class="attr">scales:</span> <span class="comment"># model compound scaling constants, i.e. &#x27;model=yolov8n.yaml&#x27; will call yolov8.yaml with scale &#x27;n&#x27;</span></span><br><span class="line">  <span class="comment"># [depth, width, max_channels]</span></span><br><span class="line">  <span class="attr">n:</span> [<span class="number">0.33</span>, <span class="number">0.25</span>, <span class="number">1024</span>] </span><br><span class="line">  <span class="attr">s:</span> [<span class="number">0.33</span>, <span class="number">0.50</span>, <span class="number">1024</span>] </span><br><span class="line">  <span class="attr">m:</span> [<span class="number">0.67</span>, <span class="number">0.75</span>, <span class="number">768</span>]  </span><br><span class="line">  <span class="attr">l:</span> [<span class="number">1.00</span>, <span class="number">1.00</span>, <span class="number">512</span>] </span><br><span class="line">  <span class="attr">x:</span> [<span class="number">1.00</span>, <span class="number">1.25</span>, <span class="number">512</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>depth：模型的深度，该系数会<strong>乘以</strong>下面的<code>repeats</code>参数，作为<strong>各模块的重复次数</strong></li>
<li>width：卷积层的厚度，该系数会<strong>乘以</strong>各个卷积相关模块给定的输出特征图的通道数，作为真正的<strong>特征图通道数</strong></li>
<li>max_channels：计算过程中特征图的最大通道数</li>
</ul>
<p><strong>二、BackBone部分</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># YOLOv8.0n backbone</span></span><br><span class="line"><span class="attr">backbone:</span></span><br><span class="line">  <span class="comment"># [from, repeats, module, args]</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">64</span>, <span class="number">3</span>, <span class="number">2</span>]]  <span class="comment"># 0-P1/2</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">128</span>, <span class="number">3</span>, <span class="number">2</span>]]  <span class="comment"># 1-P2/4</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">3</span>, <span class="string">C2f</span>, [<span class="number">128</span>, <span class="literal">True</span>]]</span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">256</span>, <span class="number">3</span>, <span class="number">2</span>]]  <span class="comment"># 3-P3/8</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">6</span>, <span class="string">C2f</span>, [<span class="number">256</span>, <span class="literal">True</span>]]</span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">512</span>, <span class="number">3</span>, <span class="number">2</span>]]  <span class="comment"># 5-P4/16</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">6</span>, <span class="string">C2f</span>, [<span class="number">512</span>, <span class="literal">True</span>]]</span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">1024</span>, <span class="number">3</span>, <span class="number">2</span>]]  <span class="comment"># 7-P5/32</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">3</span>, <span class="string">C2f</span>, [<span class="number">1024</span>, <span class="literal">True</span>]]</span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">SPPF</span>, [<span class="number">1024</span>, <span class="number">5</span>]]  <span class="comment"># 9</span></span><br></pre></td></tr></table></figure>

<p>yolo会按照配置文件实例化各个层，每行的<code>list</code>中的四个元素：[from, repeats, module, args]</p>
<ul>
<li>from：该层的输入特征图的通道数（为-1时则为上一层的输出）</li>
<li>repeats：该层模块的重复次数</li>
<li>module：所使用模块的类名</li>
<li>args：类的初始化参数（注意：实际传入module的构造函数的参数与这里的args可能有区别）</li>
</ul>
<p>以backbone的第一层为例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Conv</span>(nn.Module):</span><br><span class="line">    <span class="comment"># Standard convolution</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, c1, c2, k=<span class="number">1</span>, s=<span class="number">1</span>, p=<span class="literal">None</span>, g=<span class="number">1</span>, act=<span class="literal">True</span></span>):  <span class="comment"># ch_in, ch_out, kernel, stride, padding, groups</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="variable language_">self</span>.conv = nn.Conv2d(c1, c2, k, s, autopad(k, p), groups=g, bias=<span class="literal">False</span>)</span><br><span class="line">        <span class="variable language_">self</span>.bn = nn.BatchNorm2d(c2)</span><br><span class="line">        <span class="variable language_">self</span>.act = nn.SiLU() <span class="keyword">if</span> act <span class="keyword">is</span> <span class="literal">True</span> <span class="keyword">else</span> (act <span class="keyword">if</span> <span class="built_in">isinstance</span>(act, nn.Module) <span class="keyword">else</span> nn.Identity())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.act(<span class="variable language_">self</span>.bn(<span class="variable language_">self</span>.conv(x)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward_fuse</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.act(<span class="variable language_">self</span>.conv(x))</span><br></pre></td></tr></table></figure>

<p>在<code>parse_model()</code>中会<strong>重新组织</strong>实例化<code>Conv</code>类时传入的形参</p>
<p><img src="../assets/image-20231110193027954.png" alt="image-20231110193027954"></p>
<blockquote>
<p>也就是说：backbone第一层的<code>yaml</code>中的参数<code>args</code>&#x3D;[64, 3, 2]，**&#x3D;&#x3D;实际&#x3D;&#x3D;传入卷积层的却是[ch[-1], 64<em>width, 3, 2]</em>* &#x3D;     [3, 16, 3, 2]。第二层的<code>yaml</code>为<code>args</code> &#x3D; [128, 3, 2]，实际传入卷积层的为[16, 32, 3, 2]…</p>
</blockquote>
<p>直接看终端的LOG其实就知道了</p>
<p><img src="../assets/image-20231110193732499.png" alt="image-20231110193732499"></p>
<p><strong>三、Head部分</strong></p>
<blockquote>
<p>我个人觉得YOLOv8的<code>yaml</code>中把模型的<code>neck</code>和<code>head</code>部分全部写到一起了…</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># YOLOv8.0n head</span></span><br><span class="line"><span class="attr">head:</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">nn.Upsample</span>, [<span class="string">None</span>, <span class="number">2</span>, <span class="string">&#x27;nearest&#x27;</span>]]</span><br><span class="line">  <span class="bullet">-</span> [[<span class="number">-1</span>, <span class="number">6</span>], <span class="number">1</span>, <span class="string">Concat</span>, [<span class="number">1</span>]]  <span class="comment"># cat backbone P4</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">3</span>, <span class="string">C2f</span>, [<span class="number">512</span>]]  <span class="comment"># 12</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">nn.Upsample</span>, [<span class="string">None</span>, <span class="number">2</span>, <span class="string">&#x27;nearest&#x27;</span>]]</span><br><span class="line">  <span class="bullet">-</span> [[<span class="number">-1</span>, <span class="number">4</span>], <span class="number">1</span>, <span class="string">Concat</span>, [<span class="number">1</span>]]  <span class="comment"># cat backbone P3</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">3</span>, <span class="string">C2f</span>, [<span class="number">256</span>]]  <span class="comment"># 15 (P3/8-small)</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">256</span>, <span class="number">3</span>, <span class="number">2</span>]]</span><br><span class="line">  <span class="bullet">-</span> [[<span class="number">-1</span>, <span class="number">12</span>], <span class="number">1</span>, <span class="string">Concat</span>, [<span class="number">1</span>]]  <span class="comment"># cat head P4</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">3</span>, <span class="string">C2f</span>, [<span class="number">512</span>]]  <span class="comment"># 18 (P4/16-medium)</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">1</span>, <span class="string">Conv</span>, [<span class="number">512</span>, <span class="number">3</span>, <span class="number">2</span>]]</span><br><span class="line">  <span class="bullet">-</span> [[<span class="number">-1</span>, <span class="number">9</span>], <span class="number">1</span>, <span class="string">Concat</span>, [<span class="number">1</span>]]  <span class="comment"># cat head P5</span></span><br><span class="line">  <span class="bullet">-</span> [<span class="number">-1</span>, <span class="number">3</span>, <span class="string">C2f</span>, [<span class="number">1024</span>]]  <span class="comment"># 21 (P5/32-large)</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> [[<span class="number">15</span>, <span class="number">18</span>, <span class="number">21</span>], <span class="number">1</span>, <span class="string">Detect</span>, [<span class="string">nc</span>]]  <span class="comment"># Detect(P3, P4, P5)</span></span><br></pre></td></tr></table></figure>

<p>（1）看一下neck的<code>Concat</code>模块，在源码中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, (f, n, m, args) <span class="keyword">in</span> <span class="built_in">enumerate</span>(d[<span class="string">&#x27;backbone&#x27;</span>] + d[<span class="string">&#x27;head&#x27;</span>]):  <span class="comment"># from, number, module,args</span></span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    <span class="keyword">elif</span> m <span class="keyword">is</span> Concat:</span><br><span class="line">        c2 = <span class="built_in">sum</span>(ch[x] <span class="keyword">for</span> x <span class="keyword">in</span> f)</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        ch = []</span><br><span class="line">    <span class="comment"># .....</span></span><br><span class="line">    ch.append(c2)</span><br><span class="line">        </span><br><span class="line"><span class="comment">#ch:存了各层通道数的list</span></span><br><span class="line"><span class="comment">#f:yaml中传入的from</span></span><br><span class="line"><span class="comment">#c2:该层输出特征图的通道数</span></span><br></pre></td></tr></table></figure>

<p>即<code>Concat</code>模块会把from列表中给定的层给拼接起来。</p>
<p>（2）看一下head的输出端</p>
<blockquote>
<p>YOLOv8到底用来做什么任务需要在<code>yaml</code>的<code>head</code>的最后一层来指定</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elif</span> m <span class="keyword">in</span> (Detect, Segment, Pose):</span><br><span class="line">    args.append([ch[x] <span class="keyword">for</span> x <span class="keyword">in</span> f])</span><br><span class="line">    <span class="keyword">if</span> m <span class="keyword">is</span> Segment:</span><br><span class="line">        args[<span class="number">2</span>] = make_divisible(<span class="built_in">min</span>(args[<span class="number">2</span>], max_channels) * width, <span class="number">8</span>)</span><br><span class="line"><span class="keyword">elif</span> m <span class="keyword">is</span> RTDETRDecoder:  <span class="comment"># special case, channels arg must be passed in index 1</span></span><br><span class="line">    args.insert(<span class="number">1</span>, [ch[x] <span class="keyword">for</span> x <span class="keyword">in</span> f])</span><br></pre></td></tr></table></figure>

<hr>
<p><img src="../assets/image-20231110195348803.png" alt="image-20231110195348803"></p>
<p>当使用<strong>detect</strong>头时，from列表的输入表示：检测头要使用的特征图来自网络的第几层。</p>
<h3 id="4-2使用自己缝合的模型"><a href="#4-2使用自己缝合的模型" class="headerlink" title="4.2使用自己缝合的模型"></a>4.2使用自己缝合的模型</h3><p>主要包含以下几个步骤：</p>
<p>(1)打开<code>ultralytics/nn/modules/</code>文件夹下某个<code>.py</code>，在该文件中写好要缝合的模块的类(继承<code>nn.Module</code>)</p>
<p>(2)在<code>ultralytics/nn/tasks.py</code>文件中<code>import</code>要缝合的模块</p>
<p>(3)如果是要<strong>替换</strong>原来的模块，则在<code>parse_model()</code>这个函数中看看待替换模块在哪里<strong>被解析的</strong>，按同样的方式添加新模块</p>
<p>(4)在<code>ultralytics/cfg/models</code>文件夹下创建新的模型对应的<code>.yaml</code>文件</p>
<h2 id="5-模型推理流程"><a href="#5-模型推理流程" class="headerlink" title="5.模型推理流程"></a>5.模型推理流程</h2><p><code>python</code>API中模型推理接口的使用方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">model = YOLO(<span class="string">&#x27;yolov8n.pt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">results = model(<span class="string">&#x27;ultralytics/assets/bus.jpg&#x27;</span>)  <span class="comment"># results list</span></span><br><span class="line"><span class="comment">#or</span></span><br><span class="line">results = model.predict(<span class="string">&#x27;bus.jpg&#x27;</span>, save=<span class="literal">True</span>, imgsz=<span class="number">320</span>, conf=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这些API具体用法参考官方文档：<a target="_blank" rel="noopener" href="https://docs.ultralytics.com/modes/predict/%EF%BC%8C%E8%BF%99%E9%87%8C%E5%B0%B1%E4%B8%8D%E5%B1%95%E5%BC%80%E4%BA%86%E3%80%82">https://docs.ultralytics.com/modes/predict/，这里就不展开了。</a></p>
<p>下面主要分析代码执行流程：</p>
</blockquote>
<p><img src="../assets/image-20231110212058529.png" alt="image-20231110212058529"></p>
<h2 id="6-模型训练流程"><a href="#6-模型训练流程" class="headerlink" title="6.模型训练流程"></a>6.模型训练流程</h2><h3 id="6-2恢复训练"><a href="#6-2恢复训练" class="headerlink" title="6.2恢复训练"></a>6.2恢复训练</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">model = YOLO(<span class="string">&#x27;/home/aistudio/work/ultralytics/runs/detect/train5/weights/last.pt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">model.train(cfg=<span class="string">&#x27;./cfgs/shipoutside.yaml&#x27;</span>, </span><br><span class="line">             data=<span class="string">&#x27;/home/aistudio/work/ultralytics/dataset/shipoutside.yaml&#x27;</span>, </span><br><span class="line">             imgsz=[<span class="number">576</span>,<span class="number">1024</span>],</span><br><span class="line">             resume=<span class="literal">True</span>,</span><br><span class="line">             save_period=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>恢复训练时，必须在实例化模型时传入权重文件的路径，不然重启训练时可能不能接着上一次的<code>epoch</code>继续</p>
<p>注意：</p>
<ul>
<li>如果要<code>resume</code>训练，那么<strong>任何超参数</strong>比如上面的<code>save_period</code>之类的都是<strong>无法修改的</strong></li>
<li>根据<strong>传入权重文件的路径</strong>的不同，重新开始的<code>epoch</code>也不同</li>
<li>如果某工程已经训练完了，那么在<code>resume</code>将<strong>从零开始</strong></li>
</ul>
<h2 id="7-数据集-数据增强-源码解读"><a href="#7-数据集-数据增强-源码解读" class="headerlink" title="7.数据集(数据增强)源码解读"></a>7.数据集(数据增强)源码解读</h2><p><code>ultrlytics</code>中的数据集&#x2F;数据增强部分也是非常复杂</p>
<h3 id="7-1训练所用的Dataset类"><a href="#7-1训练所用的Dataset类" class="headerlink" title="7.1训练所用的Dataset类"></a>7.1训练所用的Dataset类</h3><p><strong>数据集类</strong>的继承拓扑关系如下：</p>
<p><img src="../assets/image-20231114113136950.png" alt="image-20231114113136950"></p>
<p>在<code>BaseDataset</code>类中，有以下属性</p>
<img src="../assets/image-20231114113314074.png" alt="image-20231114113314074" style="zoom:80%;" />

<p>其中比较重要的就是以上红框框出来的属性，在<code>ultrlytics</code>的代码框架中，数据集的<code>transforms</code>都是通过<code>build_transform()</code>这个API来获得的，基类中并没有实现该函数，需要<strong>子类（YOLODataset）进行重写</strong>。</p>
<h3 id="7-2训练时的数据增强"><a href="#7-2训练时的数据增强" class="headerlink" title="7.2训练时的数据增强"></a>7.2训练时的数据增强</h3><p><code>ultralytics</code>的数据增强分为多个步骤，下面是其执行的<strong>大致流程</strong>：</p>
<p><img src="../assets/image-20231115160204438.png"></p>
<h3 id="7-3预测时的数据增强"><a href="#7-3预测时的数据增强" class="headerlink" title="7.3预测时的数据增强"></a>7.3预测时的数据增强</h3><p><img src="../assets/image-20231115161003252.png" alt="image-20231115161003252"></p>
<h2 id="8-自动选择optimizer机制"><a href="#8-自动选择optimizer机制" class="headerlink" title="8.自动选择optimizer机制"></a>8.自动选择optimizer机制</h2><p><code>ultrlytics</code>库如果把配置文件中的optimizer设置为<code>auto</code>，则它会自动帮你选择<strong>学习率</strong>和<strong>优化器</strong>，相关源码如下：</p>
<p><img src="../assets/image-20231122153530556.png" alt="image-20231122153530556"></p>
<p>可见自动帮你选的时候，会根据总的<code>iterations</code>选择SGD或AdamW。如果总的迭代次数较多，则选择SGD，反之选择AdamW。<strong>因为SGD收敛较慢，但其最终效果却比AdamW好</strong>。因此自己训练论文中的模型时，尽量设置较大的<code>epoch</code>并使用<code>SGD</code>，这样便于得到更好的结果。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://Li-Ruiqi777.github.io">Gearless Joe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://li-ruiqi777.github.io/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/ultralytics%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.html">https://li-ruiqi777.github.io/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/ultralytics%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/PaddlePddle/PaddleDetection%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.html" title="PaddleDetection使用指南"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">PaddleDetection使用指南</div></div><div class="info-2"><div class="info-item-1">PaddleDetection使用指南PaddleDetection是和PaddleSeg类似的一个框架，不过它聚焦于目标检测领域。由于都是基于PaddlePaddle框架同一个公司开发的，所以这2者在架构上有相似之处，但也有区别。想要到时候用他来科研、缝合模型的话必须得对它的源码有深入的了解。 一、PaddleDetection能用Config文件来配置如何训练的原理PaddleDetection实现读取config文件来创建模型、数据集主要是通过以下模块： 12from ppdet.core.workspace import load_config, merge_config, global_configfrom ppdet.engine import...</div></div></div></a><a class="pagination-related" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pascal%20VOC%E6%95%B0%E6%8D%AE%E9%9B%86.html" title="Pascal VOC数据集"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Pascal VOC数据集</div></div><div class="info-2"><div class="info-item-1">Pascal...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Gearless Joe</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">179</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">25</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ultralytics%E5%BA%93%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">ultralytics库使用指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.</span> <span class="toc-text">1.全局配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E8%B7%AF%E5%BE%84"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1配置文件的路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E5%8C%85%E6%8B%AC%E5%95%A5%EF%BC%9F"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2全局配置包括啥？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E7%9A%84%E4%BF%AE%E6%94%B9"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3全局配置的修改</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%B6%85%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">2.超参数配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E9%9B%86%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.</span> <span class="toc-text">3.数据集配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E6%A8%A1%E5%9E%8B%E7%BD%91%E7%BB%9C%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.</span> <span class="toc-text">4.如何确定模型网络结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1%E4%BD%BF%E7%94%A8%E5%AE%98%E6%96%B9%E6%8F%90%E4%BE%9B%E7%9A%84%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1使用官方提供的模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1%E6%A8%A1%E5%9E%8B%E5%88%9B%E5%BB%BA%E7%9A%84%E8%BF%87%E7%A8%8B"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">4.1.1模型创建的过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%99%E6%B3%95"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">4.2.2配置文件的写法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B7%B1%E7%BC%9D%E5%90%88%E7%9A%84%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2使用自己缝合的模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%A8%A1%E5%9E%8B%E6%8E%A8%E7%90%86%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.</span> <span class="toc-text">5.模型推理流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83%E6%B5%81%E7%A8%8B"><span class="toc-number">1.6.</span> <span class="toc-text">6.模型训练流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2%E6%81%A2%E5%A4%8D%E8%AE%AD%E7%BB%83"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.2恢复训练</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%95%B0%E6%8D%AE%E9%9B%86-%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA-%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB"><span class="toc-number">1.7.</span> <span class="toc-text">7.数据集(数据增强)源码解读</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1%E8%AE%AD%E7%BB%83%E6%89%80%E7%94%A8%E7%9A%84Dataset%E7%B1%BB"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1训练所用的Dataset类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2%E8%AE%AD%E7%BB%83%E6%97%B6%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2训练时的数据增强</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3%E9%A2%84%E6%B5%8B%E6%97%B6%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3预测时的数据增强</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E8%87%AA%E5%8A%A8%E9%80%89%E6%8B%A9optimizer%E6%9C%BA%E5%88%B6"><span class="toc-number">1.8.</span> <span class="toc-text">8.自动选择optimizer机制</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/02-YOLOv1.html" title="02 YOLOv1">02 YOLOv1</a><time datetime="2025-06-04T08:29:12.964Z" title="Created 2025-06-04 16:29:12">2025-06-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/04-YOLOv3.html" title="04 YOLOv3">04 YOLOv3</a><time datetime="2025-06-04T08:29:12.964Z" title="Created 2025-06-04 16:29:12">2025-06-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/03-YOLOv2.html" title="03 YOLOv2">03 YOLOv2</a><time datetime="2025-06-04T08:29:12.964Z" title="Created 2025-06-04 16:29:12">2025-06-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/05-%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA.html" title="05 数据增强">05 数据增强</a><time datetime="2025-06-04T08:29:12.964Z" title="Created 2025-06-04 16:29:12">2025-06-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/11-%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/06-YOLOv8.html" title="06 YOLOv8">06 YOLOv8</a><time datetime="2025-06-04T08:29:12.964Z" title="Created 2025-06-04 16:29:12">2025-06-04</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By Gearless Joe</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>